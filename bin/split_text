#!/usr/bin/php
<?php
if ( empty($argv[1]) ) {
    echo "Usage: split_text <text file to split>\n";
    echo "\n";
    echo "The text file will be split where tags <split> or <break> are found.\n";
    exit();
}
if ( !file_exists($argv[1]) ) {
    echo "File not found: ".$argv[1]."\n";
    exit();
}
$ext = pathinfo($argv[1], PATHINFO_EXTENSION);
$name = basename($argv[1],".". $ext);
$contents = file_get_contents($argv[1]);
$contents = str_replace("<break/>","<break>",$contents);
$contents = str_replace("<BREAK/>","<break>",$contents);
$contents = str_replace("<BREAK>","<break>",$contents);
$contents = str_replace("<split/>","<break>",$contents);
$contents = str_replace("<SPLIT/>","<break>",$contents);
$contents = str_replace("<SPLIT>","<break>",$contents);
@mkdir($name);
@chdir($name);
$parts = explode("<break>",$contents);
$counter = 0;
$pad = strlen(count($parts));
foreach( $parts as $part ){
    $counter++;
    file_put_contents(str_pad($counter,$pad,"0",STR_PAD_LEFT)."_".$name.".".$ext, $part);
}
